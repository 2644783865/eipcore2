var currentindex=1,timerID,$submitButton=$("#submit"),$submitMsg=$("#submitMsg"),$code=$("#userCode"),$pwd=$("#userPwd"),isVerify=!1;method={bindEvent:function(){$submitButton.click(function(){method.submit()});$("#userCode,#userPwd,#verify").bind("keypress",function(n){n.keyCode==="13"&&method.submit()})},submit:function(){var n=$submitButton.button("loading"),t=$code.val(),i=$pwd.val();if(t===""){$code.focus();n.button("reset");n.dequeue();method.formMessage("请输入用户名","warning","warning");return}if(i===""){$pwd.focus();n.button("reset");n.dequeue();method.formMessage("请输入密码","warning","warning");return}if(!isVerify){n.button("reset");n.dequeue();method.formMessage("请按住滑块，拖动到最右边","warning","warning");return}method.formMessage("正在登录中,请稍等...","success","spinner fa-spin");$.post(Language.common.apiurl+"/Account/Login",{code:t,pwd:i,remberme:$("#remember").prop("checked"),returnUrl:$("#returnHidden").val()},function(t){var i=t.ResultSign,r=t.Message;$("#btnSubmit").removeAttr("disabled");i===2?(n.button("reset"),n.dequeue(),method.formMessage(r,"danger","ban")):(method.formMessage("登录验证成功,正在跳转首页","success","check"),setInterval(method.writeAuthorizationBearerLocalStorage(t),1e3))},"json").success(function(){}).error(function(){n.button("reset");n.dequeue();method.formMessage("登录失败,请稍后重试","danger","ban")}).complete(function(){})},writeAuthorizationBearerLocalStorage:function(n){var t=window.localStorage;return t.Authorization="Bearer "+n.Data,t.UserName=n.UserName,t.OrganizationId=n.OrganizationId,t.OrganizationName=n.OrganizationName,t.Code=n.Code,t.HeadImage=n.HeadImage===""||n.HeadImage===null?"/css/user/avatar.jpg":n.HeadImage,window.location.href="/",!1},formMessage:function(n,t,i){$submitMsg.show().html("").attr("class","callout callout-"+t);$submitMsg.append('<h5><i class="icon fa fa-'+i+'"><\/i>'+n+" <\/h5>")}};$(document).ready(function(){$code.focus();method.bindEvent();$("input").iCheck({checkboxClass:"icheckbox_square-blue",radioClass:"iradio_square-blue",increaseArea:"20%"})});$(document).ajaxStart(function(){Pace.restart()});var box=document.getElementById("verify_box"),xbox=document.getElementById("verify_xbox"),element=document.getElementById("btn"),b=box.offsetWidth,o=element.offsetWidth;element.ondragstart=function(){return!1};element.onselectstart=function(){return!1};element.onmousedown=function(n){var t=n.clientX-element.offsetLeft;document.onmousemove=function(n){var i=n.clientX-t+o;i<o&&(i=o);i>b&&(i=b);xbox.style.width=i+"px"};document.onmouseup=function(n){var i=n.clientX-t+o;i<b?i=o:(i=b,isVerify=!0,xbox.innerHTML='验证通过<div id="btn"><img src="../../../css/login/images/ok.png"/><\/div>');xbox.style.width=i+"px";document.onmousemove=null;document.onmouseup=null}};